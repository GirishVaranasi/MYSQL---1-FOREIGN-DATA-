CREATE DATABASE FOREIGNDATA;
USE FOREIGNDATA;
CREATE TABLE SALESPEOPLE (
    SNUM INT PRIMARY KEY,
    SNAME VARCHAR(255),
    CITY VARCHAR(255),
    COMM DECIMAL(8 , 3 )
); 
INSERT INTO SALESPEOPLE VALUES
(1001,'PEEL','LONDON',0.12),
(1002,'SERRES','SAN JOSE',0.13),
(1004,'MOTIKA','LONDON',0.11),
(1007,'RAFKIN','BARCELONA',0.15),
(1003, 'AXELROD','NEW YORK',0.1);

SELECT 
    *
FROM
    SALESPEOPLE;

CREATE TABLE CUST (
    CNUM INT PRIMARY KEY,
    CNAME VARCHAR(255),
    CITY VARCHAR(255),
    RATING INT,
    SNUM INT
); 
INSERT INTO CUST VALUES
 (2001,'HOFFMAN','LONDON',100,1001),
(2002,'GIOVANNE','ROME',200,1003),
(2003,'LIU','SANJOSE',300,1002),
(2004,'GRASS','BERLIN',100,1002),
(2006,'Ã‡LEMENS','LONDON',300,1007),
(2007,'PEREIA','ROME',100,1004); 

SELECT 
    *
FROM
    CUST 

CREATE TABLE ORDERS (
    ONUM INT PRIMARY KEY,
    AMT FLOAT,
    ODATE DATE,
    CNUM INT,
    SNUM INT
) 
INSERT INTO ORDERS VALUES 
(3001,18.69,"1994-10-03",2008,1007),
(3003,767.19,"1994-10-03",2001,1001),
(3002,1900.10,"1994-10-03",2007,1004),
(3005,5160.45,"1994-10-03",2003,1002),
(3006,1098.16,"1994-10-04",2008,1007),
(3009,1713.23,"1994-10-04",2002,1003), 
(3007,75.75,"1994-10-05",2006,1002),
(3008,4723,"1994-10-05",2006,1001),
(3010,1309.95,"1994-10-06",2004,1002),
(3011,9891.88,"1994-10-06",2006,1001); 
 
SELECT 
    *
FROM
    ORDERS
 USE FOREIGNDATA;
 ALTER TABLE ORDERS MODIFY AMT FLOAT;
DROP TABLE ORDERS;

---- DISPLAY SNUM,SNAME,CITY AND COMM OF ALL SALESPEOPLE

SELECT SNUM,SNAME,CITY,COMM FROM SALESPEOPLE; 

---- DISPLAY ALL SNUM WITHOUT DUPLICATES FROM ALL ORDERS

SELECT DISTINCT(SNUM) FROM SALESPEOPLE; 

---DISPLAY NAMES AND COMM OF ALL SALESPEOPLE IN LONDON 

SELECT SNAME, COMM FROM SALESPEOPLE WHERE CITY="LONDON";

----ALL CUSTOMERS WITH RATING OF 100.

 SELECT  CNAME,RATING FROM CUST WHERE RATING =100;
 
 ---PRODUCE ORDERNO,AMOUNT AND DATE FROM ALL ROWS IN THE ORDER TABLE.
 
 SELECT ONUM,ODATE,AMT FROM ORDERS; 
 
 --- ALL CUSTOMERS IN SAN JOSE WHO HAVE RATING MORE THAN 200.
 
 SELECT CNAME,RATING FROM CUST WHERE CITY="SANJOSE" AND RATING >=200; 
 
 --- ALL CUSTOMERS WHO WERE EITHER LOCATED IN SAN JOSE OR HAD RATING MORE THAN 200.
 
 SELECT CNAME,RATING,CITY FROM CUST WHERE CITY="SANJOSE" OR RATING >=200;  
 
 --- ALL ORDERS MORE THAN $1000
 
 SELECT * FROM ORDERS WHERE AMT>1000; 
 
 --- NAMES AND CITIES OF ALL SALESPEOPLE IN LONDON WITH COMM ABOVE .10
 
 SELECT SNAME,CITY FROM SALESPEOPLE WHERE COMM>0.10 AND CITY="LONDON" 
 
 --ALL CUSTOMERS EXCLUDING THOSEE WITH RATING <=100 UNLESS THEY ARE LOCATED IN ROME.
 
 SELECT CNAME,CITY,RATING FROM CUST WHERE RATING <=100 OR CITY ="ROME";
 
  ---ALL SALESPEOPLE EITHER IN BARCELONA OR IN LONDON
   
   SELECT SNAME,CITY FROM SALESPEOPLE WHERE CITY= "BARCELONA"OR"LONDON"; 
   
   --- ALL SALESPEPLE WITH COMM BETWEEN 0.10 AND 0.12 ( BOUNDARY VALUES SHOULD BE EXCLUDED)
   
   SELECT SNAME, COMM  FROM SALESPEOPLE WHERE COMM >0.10 AND COMM<0.12;
   
   --- ALL CUSTOMERS WITH NULL VALUES IN CITY COLUMN.
   
   SELECT CNAME FROM CUST WHERE CITY=NULL; 
   
   --- ALL ORDES TAKEN ON OCT 3RD AND 4TH OCT 1994.
    SELECT * FROM ORDERS WHERE ODATE IN ("1994-10-03","1994-10-04");
    
   --- ALL CUSTOMERS SERVICED BY PEEL OR MOTIKA.

    
    SELECT CNAME FROM CUST
    JOIN SALESPEOPLE ON
     SALESPEOPLE.SNUM=CUST.SNUM
    JOIN ORDERS ON
     ORDERS.CNUM=CUST.CNUM
    WHERE ORDERS.SNUM IN (SELECT SNUM FROM SALESPEOPLE WHERE SNAME IN ("PEEL","MOTIKA"));  
    ---- (OR)
    SELECT CNAME FROM CUST, ORDERS WHERE ORDERS.CNUM=CUST.CNUM AND 
    ORDERS.SNUM IN (SELECT SNUM FROM SALESPEOPLE WHERE SNAME IN ("PEEL","MOTIKA"));
    
    --- ALL ORDERS EXCEPT THOSE WITH O OR NULL VALUES
    
    SELECT ONUM FROM ORDERS WHERE AMT=0 OR AMT IS NOT NULL;
    
    --- COUNT THE NO OF SALESPEOPLE CURRENTLY LISTING ORDERS IN THE ORDER TABLE. 
    
    SELECT COUNT( DISTINCT SNUM ) FROM ORDERS;
    
    --- LARGEST ORDERS TKAEN BY EACH SALESPERSON, DATEWISE.
    
    SELECT ODATE,SNUM, MAX(AMT) FROM ORDERS GROUP BY ODATE,
    SNUM ORDER BY ODATE,SNUM;
    
    --- LARGEST ORDERS TKAEN BY EACH SALESPERSON, WITH OREDR VALUE MORE THAN 3000.
    
     SELECT ODATE,SNUM, MAX(AMT) FROM ORDERS WHERE AMT>3000 GROUP BY ODATE,
    SNUM ORDER BY ODATE,SNUM;
    
    --- WHICH DAY HAS THE HIGHEST TOTAL AMOUNT ORDERED.
    
    SELECT ODATE, MAX(AMT) FROM ORDERS
    GROUP BY ODATE ORDER BY MAX(AMT) DESC;
    
    --- COUNT ALL ORDERSFOR 03-OCT-1994
    
    SELECT COUNT(*) FROM ORDERS WHERE ODATE= "1994-10-03"; 
    
    --- COUNT THE DIFF NOT NULL CITOES VALUES IN CUSTOMER TABLE
    
    SELECT COUNT(DISTINCT CITY) FROM CUST;  
    
    --- SELECT EACH CUST SMALL ORDER
    
    SELECT CNAME,MIN(AMT) FROM ORDERS
    GROUP BY CNAME ORDER BY MIN(AMT);
    --- fIRST CUSTOMERIN ALPHABETICALORDER WHOSENAME BEGINWITH G
    
    SELECT MIN(CNAME) FROM CUST WHERE CNAME LIKE 'G%';
     
	--- ASSUME THAT EACH SALESPERSON HAS 12% HIKE PRODUCE ONUM,SNUMAND AMT OF SALESPERSON COMM FOR THAT ORDER
     
     SELECT ONUM,SNUM,AMT,AMT*.12 AS HIKE FROM ORDERS ORDER BY SNUM;
     
     ---  FIND THE HIGHEST RATINGIN EACHCITY PUT OUTPUT INTHE FORM FORTHR CITY(CITY)
	 --- THE HIGHEST RATING(RATING).
           
	SELECT CITY, MAX(RATING) AS RATING  FROM CUST GROUP BY CITY;
    
    --- DISPLAY THE ORDERS OF EACH DAY AND PLACE RESSULTS IN desc
    
    SELECT ODATE,COUNT(ONUM)  FROM ORDERS GROUP BY ODATE ORDER BY COUNT(ONUM) DESC;
    
    --- ALL COMBINATIONS OF SALESPEOPLE AND CUSTOMERS WHO SHARED A SAMECITY.
    
    SELECT SNAME,CNAME FROM SALESPEOPLE, CUST 
    WHERE SALESPEOPLE.CITY=CUST.CITY;
    
    --- NAME ALL THE CUSTOMERS MATCHED WITH THE SALESPEOPLE SERVING THEM
    
     SELECT SNAME,CNAME FROM SALESPEOPLE, CUST 
    WHERE SALESPEOPLE.SNUM=CUST.SNUM;
    
    --- LIST EACH ORDER FOLLOWE BY THE NAME OF CUSTOMER WHO MADE THE ORDER
    
     SELECT CNAME,ONUM FROM  CUST,ORDERS
        WHERE CUST.CNUM= ORDERS.CNUM;
        
	---- NAME OF SALESPERSON AND CUSTOMER FOR EACH ORDER AFTER THE ODER NUM
    
   SELECT 
    ONUM, SNAME, CNAME
FROM
    ORDERS,
    CUST,
    SALESPEOPLE
WHERE
    ORDERS.CNUM = CUST.CNUM
        AND ORDERS.SNUM = SALESPEOPLE.SNUM;
    
    --- PRODUCE ALL CUSTOMERS SERVICED BY SALESPEOPLE WITH COMM ABOVE 12%.
    
   SELECT 
    SNAME, CNAME, COMM
FROM
    CUST,
    SALESPEOPLE
WHERE
    COMM > 0.12
        AND CUST.SNUM = SALESPEOPLE.SNUM;
    
    --- CALCULATE THE AMPUNT OF SALESPERSONS COMMON EACH ORDER WITH A RATING ABOVE 
    
   SELECT 
    SNAME, AMT * COMM
FROM
    ORDERS,
    CUST,
    SALESPEOPLE
WHERE
    RATING > 100
        AND SALESPEOPLE.SNUM = CUST.SNUM
        AND SALESPEOPLE.SNUM = ORDERS.SNUM
        AND CUST.CNUM = ORDERS.CNUM;
        
---- FIND ALL PAIRS OF CUSTOMERS HAVING SAME RATING
SELECT 
    a.cname, b.cname, a.rating
FROM
    cust a,
    cust b
WHERE
    a.rating = b.rating AND a.cnum != b.cnum;
    
--- POLICY IS TO ASSIGN 3 SALES PERSONS TO EACH CUSTOMERS 
 ---  DISPLAY ALL SUCH COMBINATIONS
   
   Select a.cname, b.cname,a.rating from cust a, cust b 
   where a.rating = b.rating and a.cnum != b.cnum and a.cnum <> b.cnum;
   
   ---- DISPLAY ALL CUSTOMERS LOCATD IN CITIES WHERE SALESMAN SERRES HAS CUSTOMERS. 
   
        Select cname, sname from salespeople, cust 
        where sname = "serres" group by cname;
	
    ---- PRODUCE NAMES AND CITIES OF ALL CUSTOMERS WITH SAME RATING AS HOFFMAN
    
    Select cname, city,rating from cust 
    where rating = (select rating from cust where cname = 'Hoffman') 
    and cname != 'Hoffman';

   ---- extract all orders of motika
   Select count(onum) from orders	
   where snum = ( select snum from salespeople where sname = 'serres');
   
   ---- ALL ORDERS THAT ARE GREATER THAN AVG OF OCT 4
   Select * from orders 
   where amt > ( select avg(amt) from orders where odate = '1994-10-04');
   
   --- FIND AVG COMM OF SALESPEOPLE IN LONDON
   SELECT AVG(COMM) FROM SALESPEOPLE WHERE CITY = "LONDON";
   
   --- FIND ALL ORDERS ATTRIBUTED TO SALESPEOPLE SERVICNG CUSTOMERS IN LONDON
   Select snum, cnum from orders
   where cnum in (select cnum from cust where city = 'London');
   
   --- EXTRACT COMM OF ALL SALESPEOPLE SERVICNG CUSTOMERS IN LONDON 
   Select SNAME, COMM from SALESPEOPLE
   where Snum in (select Snum from cust where city = 'London');
   
   --- FIND ALL CUSTOMERS WHOSE CNUM IS 1000 ABOVE SNUM OF SERRES
   Select cnum, cname from cust 
   where cnum > ( select snum+1000 from salespeople where sname = 'Serres');
   
   --- COUNT THE CUSTOMERS WITH RATING ABOVE SAN JOSE AVG
   SELECT CNUM,RATING FROM CUST
   WHERE RATING< ( SELECT AVG(RATING) FROM CUST WHERE CITY = "SANJOSE");